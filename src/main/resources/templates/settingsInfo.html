<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Social - Network, Community and Event Theme</title>
    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Webestica.com">
    <meta name="description" content="Bootstrap based News, Magazine and Blog Theme">
    <!-- Favicon -->
    <link rel="shortcut icon" th:href="@{/assets/images/favicon.ico}">
    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <!-- Plugins CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/font-awesome/css/all.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/bootstrap-icons/bootstrap-icons.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/choices.js/public/assets/styles/choices.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/dropzone/dist/dropzone.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/flatpickr/dist/flatpickr.css}" />
    <!-- Theme CSS -->
    <link id="style-switch" rel="stylesheet" type="text/css" th:href="@{/assets/css/style.css}">
</head>
<body>

<header class="navbar-light fixed-top header-static bg-mode">
    <!-- ... Navbar omitted ... -->
</header>

<main>
    <div class="container">
        <div class="row">
            <!-- Sidenav omitted -->
            <div class="col-lg-6 vstack gap-4">
                <div class="tab-content py-0 mb-0">
                    <div class="tab-pane show active fade" id="nav-setting-tab-1">
                        <div class="card mb-4">
                            <div class="card-header border-0 pb-0">
                                <h1 class="h5 card-title">Account Settings</h1>
                            </div>
                            <div class="card-body">
                                <!-- Form: support file upload -->
                                <form th:action="@{/utilisateurs/{id}/modifier-info(id=${utilisateur.idU})}"
                                      th:object="${utilisateur}"
                                      method="post"
                                      class="row g-3"
                                      enctype="multipart/form-data">

                                    <!-- Avatar preview & upload -->
                                    <div class="col-sm-12 text-center">
                                        <label for="avatarFile" style="cursor:pointer;">
                                            <img id="avatarPreview"
                                                 th:src="@{${utilisateur.avatarU}}"
                                                 alt="Avatar"
                                                 class="rounded-circle mb-2"
                                                 style="width:120px; height:120px; object-fit:cover; border:2px solid #ddd;" />
                                            <div class="small text-muted">Click to change avatar</div>
                                        </label>
                                        <input type="file"
                                               id="avatarFile"
                                               name="avatarFile"
                                               accept="image/*"
                                               style="display:none;"
                                               onchange="previewAvatar(this)" />
                                    </div>

                                    <!-- Email (readonly) -->
                                    <div class="col-sm-6">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-control" th:field="*{emailU}" readonly />
                                    </div>

                                    <!-- INE (readonly) -->
                                    <div class="col-sm-6">
                                        <label class="form-label">INE</label>
                                        <input type="text" class="form-control" th:field="*{ine}" readonly />
                                    </div>

                                    <!-- Last Name -->
                                    <div class="col-sm-6">
                                        <label class="form-label">Last Name</label>
                                        <input type="text" class="form-control" th:field="*{nomU}" />
                                    </div>

                                    <!-- First Name -->
                                    <div class="col-sm-6">
                                        <label class="form-label">First Name</label>
                                        <input type="text" class="form-control" th:field="*{prenomU}" />
                                    </div>

                                    <!-- Birthday -->
                                    <div class="col-sm-6">
                                        <label class="form-label">Date of Birth</label>
                                        <input type="date" class="form-control" th:field="*{birthday}" />
                                    </div>

                                    <!-- Telephone -->
                                    <div class="col-sm-6">
                                        <label class="form-label">Phone</label>
                                        <input type="text" class="form-control" th:field="*{telephone}" placeholder="optional" />
                                    </div>

                                    <!-- University -->
                                    <div class="col-sm-6">
                                        <label class="form-label">University</label>
                                        <input type="text" class="form-control" th:field="*{universite}" />
                                    </div>

                                    <!-- City -->
                                    <div class="col-sm-6">
                                        <label class="form-label">City</label>
                                        <input type="text" class="form-control" th:field="*{ville}" />
                                    </div>

                                    <!-- Description -->
                                    <div class="col-12">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" rows="3" th:field="*{descriptionU}"></textarea>
                                    </div>

                                    <!-- Submit -->
                                    <div class="col-12 text-end">
                                      <a th:href="@{/utilisateurs/{id}/profile-post(id=${sessionUser.idU})}" class="btn btn-secondary me-2">Back</a>
                                      <button type="submit" class="btn btn-primary">Save</button>
                                    </div>
                                </form>

                                <!-- Avatar preview script -->
                                <script>
                                    function previewAvatar(input) {
                                        if (input.files && input.files[0]) {
                                            const reader = new FileReader();
                                            reader.onload = e => {
                                                document.getElementById('avatarPreview').src = e.target.result;
                                            };
                                            reader.readAsDataURL(input.files[0]);
                                        }
                                    }
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Scripts -->
<script th:src="@{/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/assets/vendor/choices.js/public/assets/scripts/choices.min.js}"></script>
<script th:src="@{/assets/vendor/dropzone/dist/dropzone.js}"></script>
<script th:src="@{/assets/vendor/flatpickr/dist/flatpickr.min.js}"></script>
<script th:src="@{/assets/vendor/pswmeter/pswmeter.min.js}"></script>
<script th:src="@{/assets/js/functions.js}"></script>
</body>
</html>
